OSSEC Commands
================

# Documentation

OSSEC: https://www.ossec.net/docs/
Wazuh: https://documentation.wazuh.com/current/getting-started/index.html

Troubleshooting: https://ossec-docs.readthedocs.io/en/latest/faq/unexpected.html

# Logs

location: /var/ossec/logs

# Manager

## List agent

```
/var/ossec/bin/agent_control -l
```

```
curl -u foo:bar "https://localhost:55000/agents?pretty" -k
```

## Remove agent

```
/var/ossec/bin/manage_agents -r 009
```

```
curl -u foo:bar -X DELETE "https://localhost:55000/agents/009" -k
```

## Add agent

```
curl -u foo:bar -X POST -d 'name=wazuh-agent-96fb76c96-2rt4k&ip=100.96.6.16' "https://localhost:55000/agents" -k

curl -u foo:bar -X GET "https://localhost:55000/agents/002/key" -k
```

# Agents

## Add key
Add the key that was generated by `Add agent`
```
/var/ossec/bin/manage_agents -i MDAyIHdhenVoLWFnZW50LTdjZj
```

## Add agent via authd

```
/var/ossec/bin/agent-auth -m wazuh-manager -p 1515
```

## Start all agent process

```
/var/ossec/bin/ossec-control start
```
